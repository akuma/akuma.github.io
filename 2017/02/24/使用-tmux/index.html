<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 使用 tmux · Coding Life</title><meta name="description" content="使用 tmux - Akuma Huang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://akuma.github.io/atom.xml" title="Coding Life"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/akuma" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">使用 tmux</h1><div class="post-info">Feb 24, 2017</div><div class="post-content"><h2 id="配置-ssh-agent-forwarding"><a href="#配置-ssh-agent-forwarding" class="headerlink" title="配置 ssh agent forwarding"></a>配置 ssh agent forwarding</h2><h3 id="ssh-rc"><a href="#ssh-rc" class="headerlink" title=".ssh/rc"></a>.ssh/rc</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/bin/bash</span></div><div class="line"></div><div class="line"><span class="comment"># http://techblog.appnexus.com/2011/managing-ssh-sockets-in-gnu-screen/</span></div><div class="line"><span class="comment"># https://gist.github.com/martijnvermaat/8070533</span></div><div class="line"><span class="comment"># http://stackoverflow.com/questions/21378569/how-to-auto-update-ssh-agent-environment-variables-when-attaching-to-existing-tm</span></div><div class="line"></div><div class="line"><span class="comment"># Fix SSH auth socket location so agent forwarding works with screen.</span></div><div class="line"><span class="keyword">if</span> <span class="built_in">test</span> <span class="string">"<span class="variable">$SSH_AUTH_SOCK</span>"</span> ; <span class="keyword">then</span></div><div class="line">    ln -sf <span class="variable">$SSH_AUTH_SOCK</span> ~/.ssh/ssh_auth_sock.$(hostname)</div><div class="line"><span class="keyword">fi</span></div><div class="line"></div><div class="line"><span class="comment"># Don't break x11 Forwarding:</span></div><div class="line"><span class="comment"># Taken from the sshd(8) manpage.</span></div><div class="line"><span class="keyword">if</span> <span class="built_in">read</span> proto cookie &amp;&amp; [ -n <span class="string">"<span class="variable">$DISPLAY</span>"</span> ]; <span class="keyword">then</span></div><div class="line">        <span class="keyword">if</span> [ `<span class="built_in">echo</span> <span class="variable">$DISPLAY</span> | cut -c1-10` = <span class="string">'localhost:'</span> ]; <span class="keyword">then</span></div><div class="line">                <span class="comment"># X11UseLocalhost=yes</span></div><div class="line">                <span class="built_in">echo</span> add unix:`<span class="built_in">echo</span> <span class="variable">$DISPLAY</span> |</div><div class="line">                    cut -c11-` <span class="variable">$proto</span> <span class="variable">$cookie</span></div><div class="line">        <span class="keyword">else</span></div><div class="line">                <span class="comment"># X11UseLocalhost=no</span></div><div class="line">                <span class="built_in">echo</span> add <span class="variable">$DISPLAY</span> <span class="variable">$proto</span> <span class="variable">$cookie</span></div><div class="line">        <span class="keyword">fi</span> | xauth -q -</div><div class="line"><span class="keyword">fi</span></div></pre></td></tr></table></figure>
<h3 id="tmux-conf"><a href="#tmux-conf" class="headerlink" title=".tmux.conf"></a>.tmux.conf</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div></pre></td><td class="code"><pre><div class="line"># .tmux.conf</div><div class="line"></div><div class="line"># -- general -------------------------------------------------------------------</div><div class="line"></div><div class="line">set -g default-terminal &apos;screen-256color&apos; # colors!</div><div class="line">set -s quiet on                           # disable various messages</div><div class="line">set -s escape-time 0                      # fastest command sequences</div><div class="line">set -sg repeat-time 600                   # increase repeat timeout</div><div class="line">setw -g xterm-keys on</div><div class="line"></div><div class="line">set -g prefix2 C-a                        # GNU-Screen compatible prefix</div><div class="line">bind C-a send-prefix -2</div><div class="line"></div><div class="line">set -q -g status-utf8 on                  # expect UTF-8 (tmux &lt; 2.2)</div><div class="line">setw -q -g utf8 on</div><div class="line"></div><div class="line">set -g history-limit 5000                 # boost history</div><div class="line"></div><div class="line"># reload configuration</div><div class="line">bind r source-file ~/.tmux.conf \; display &apos;tmux.conf reloaded!&apos;</div><div class="line"></div><div class="line"># vi style copy/paste</div><div class="line">setw -g mode-keys vi</div><div class="line">bind Escape copy-mode</div><div class="line">#unbind p</div><div class="line">#bind p paste-buffer        # doesn&apos;t work</div><div class="line">bind -t vi-copy &apos;v&apos; begin-selection</div><div class="line">#bind -t vi-copy &apos;y&apos; copy-selection</div><div class="line">#bind -t vi-copy y copy-pipe &apos;reattach-to-user-namespace pbcopy&apos; # For macOS</div><div class="line"></div><div class="line"></div><div class="line"># -- display -------------------------------------------------------------------</div><div class="line"></div><div class="line">set -g base-index 1         # start windows numbering at 1</div><div class="line">setw -g pane-base-index 1   # make pane numbering consistent with windows</div><div class="line"></div><div class="line">setw -g automatic-rename on # rename window to reflect current program</div><div class="line">set -g renumber-windows on  # renumber windows when a window is closed</div><div class="line"></div><div class="line">set -g set-titles on                        # set terminal title</div><div class="line">set -g set-titles-string &apos;#h ❐ #S ● #I #W&apos;</div><div class="line"></div><div class="line">set -g display-panes-time 800 # slightly longer pane indicators display time</div><div class="line">set -g display-time 1000      # slightly longer status messages display time</div><div class="line"></div><div class="line">set -g status-interval 10     # redraw status line every 10 seconds</div><div class="line"></div><div class="line"># clear both screen and history</div><div class="line">bind -n C-l send-keys C-l \; run &apos;sleep 0.05 &amp;&amp; tmux clear-history&apos;</div><div class="line"></div><div class="line"># activity</div><div class="line">set -g monitor-activity on</div><div class="line">set -g visual-activity on</div><div class="line"></div><div class="line"># set the status line style</div><div class="line">set -g status-left-length 40</div><div class="line">set -g status-left &apos;#[fg=green][#S] #[fg=red]w:#I #[fg=yellow]p:#P&apos;</div><div class="line">set -g status-right &apos;#h %D %H:%M&apos;</div><div class="line">set -g status-justify centre</div><div class="line"></div><div class="line"># set the status line&apos;s colors</div><div class="line">set -g status-fg green</div><div class="line">set -g status-bg black</div><div class="line"></div><div class="line"># set the color of the window list</div><div class="line">setw -g window-status-fg black</div><div class="line">setw -g window-status-bg cyan</div><div class="line">setw -g window-status-attr dim</div><div class="line"></div><div class="line"># set colors for the active window</div><div class="line">setw -g window-status-current-fg white</div><div class="line">setw -g window-status-current-bg red</div><div class="line">setw -g window-status-current-attr bright</div><div class="line"></div><div class="line"># pane colors</div><div class="line">set -g pane-border-fg default</div><div class="line">set -g pane-border-bg default</div><div class="line">set -g pane-active-border-fg green</div><div class="line">set -g pane-active-border-bg default</div><div class="line"></div><div class="line"></div><div class="line"># -- navigation ----------------------------------------------------------------</div><div class="line"></div><div class="line"># find session</div><div class="line">bind C-f command-prompt -p find-session &apos;switch-client -t %%&apos;</div><div class="line"></div><div class="line"># pane navigation</div><div class="line">bind -r h select-pane -L  # move left</div><div class="line">bind -r j select-pane -D  # move down</div><div class="line">bind -r k select-pane -U  # move up</div><div class="line">bind -r l select-pane -R  # move right</div><div class="line">bind &gt; swap-pane -D       # swap current pane with the next one</div><div class="line">bind &lt; swap-pane -U       # swap current pane with the previous one</div><div class="line"></div><div class="line"># pane resizing</div><div class="line">bind -r H resize-pane -L 2</div><div class="line">bind -r J resize-pane -D 2</div><div class="line">bind -r K resize-pane -U 2</div><div class="line">bind -r L resize-pane -R 2</div><div class="line"></div><div class="line"># pane splitting</div><div class="line">bind | split-window -h</div><div class="line">bind - split-window -v</div><div class="line"></div><div class="line"># pane synchronization</div><div class="line">bind C-z setw synchronize-panes</div><div class="line"></div><div class="line"># window navigation</div><div class="line">unbind n</div><div class="line">unbind p</div><div class="line">bind -r C-n next-window     # select next window</div><div class="line">bind -r C-p previous-window # select previous window</div><div class="line">bind Tab last-window        # move to last active window</div><div class="line"></div><div class="line"># mouse support</div><div class="line">#set -g mode-mouse off</div><div class="line">set -g mouse-select-pane on</div><div class="line">set -g mouse-resize-pane on</div><div class="line">set -g mouse-select-window on</div><div class="line"></div><div class="line"># ssh agent forwarding for tmux</div><div class="line">set -g update-environment -r</div><div class="line">setenv -g SSH_AUTH_SOCK $HOME/.ssh/ssh_auth_sock.$HOSTNAME</div></pre></td></tr></table></figure>
</div></article></div></section><footer><div class="paginator"><a href="/2017/01/13/几个常用的-Linux-系统分析工具/" class="next">下一篇</a></div><div data-thread-key="2017/02/24/使用-tmux/" data-title="使用 tmux" data-url="https://akuma.github.io/2017/02/24/使用-tmux/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"iakuma"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2009 - 2017 <a href="https://akuma.github.io">Akuma Huang</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>